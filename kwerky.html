<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KWERKY.IO - GBA Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Silkscreen&display=swap" rel="stylesheet">
    <style>
        /* GBA-inspired aesthetic */
        body {
            font-family: 'Silkscreen', sans-serif;
            background-color: #d1d5db; /* Light grey background */
            color: #374151;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 1rem;
        }

        .font-press-start {
            font-family: 'Press Start 2P', cursive;
        }

        /* The main GBA console body */
        .gba-container {
            background-color: #4f46e5; /* Indigo/Purple GBA color */
            border-radius: 1rem 1rem 4rem 1rem;
            padding: 1.5rem;
            width: 100%;
            max-width: 1000px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2), inset 0 0 15px rgba(0,0,0,0.4);
            display: flex;
            flex-direction: column;
            border: 2px solid #3b33b5;
        }

        /* The "screen" area */
        .gba-screen {
            background-color: #9ca3af; /* Screen background color */
            border-radius: 0.5rem;
            padding: 1.5rem;
            box-shadow: inset 0 0 10px #374151;
            border: 4px solid #1f2937;
            margin-bottom: 1.5rem;
        }

        /* Decorative elements container */
        .gba-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 1rem;
            user-select: none; /* Prevent text selection on controls */
        }

        /* D-Pad styling */
        .d-pad { position: relative; width: 90px; height: 90px; }
        .d-pad .vertical, .d-pad .horizontal {
            background-color: #1f2937;
            position: absolute;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
            transition: all 0.1s ease;
            pointer-events: none; /* Visuals don't capture mouse events */
        }
        /* Style for when D-pad is pressed */
        .d-pad .vertical.pressed, .d-pad .horizontal.pressed {
            transform: translateY(1px);
            box-shadow: 0 1px 2px rgba(0,0,0,0.4);
            background-color: #374151;
        }
        .d-pad .vertical { width: 30px; height: 90px; left: 30px; top: 0; border-radius: 6px; }
        .d-pad .horizontal { width: 90px; height: 30px; left: 0; top: 30px; border-radius: 6px; }
        
        /* Clickable areas for D-pad (overlays) */
        .d-pad .up, .d-pad .down, .d-pad .left, .d-pad .right {
            position: absolute;
            cursor: pointer;
            z-index: 1;
        }
        .d-pad .up { top: 0; left: 30px; width: 30px; height: 30px; }
        .d-pad .down { bottom: 0; left: 30px; width: 30px; height: 30px; }
        .d-pad .left { top: 30px; left: 0; width: 30px; height: 30px; }
        .d-pad .right { top: 30px; right: 0; width: 30px; height: 30px; }


        /* A and B buttons styling */
        .ab-buttons { display: flex; gap: 1rem; }
        .ab-buttons .button {
            width: 50px; height: 50px; border-radius: 50%; display: flex; justify-content: center; align-items: center;
            font-family: 'Press Start 2P', cursive; color: rgba(255,255,255,0.7); font-size: 1.25rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3), inset 0 -4px 2px rgba(0,0,0,0.2);
            border: 2px solid rgba(0,0,0,0.4); transition: all 0.1s ease; cursor: pointer;
        }
        .ab-buttons .button:active, .ab-buttons .button.pressed {
            transform: translateY(2px);
            box-shadow: 0 2px 3px rgba(0,0,0,0.3), inset 0 -2px 1px rgba(0,0,0,0.2);
        }
        .button.a-button { background-color: #ef4444; /* Red */ }
        .button.b-button { background-color: #22c55e; /* Green */ }
        
        /* Project card styling */
        .project-card {
            background-color: #e5e7eb; border: 3px solid #4b5563; border-radius: 0.5rem;
            transition: all 0.2s ease-in-out; cursor: pointer;
        }
        .project-card:hover { transform: scale(1.03); }
        /* Selected state for the card */
        .project-card.selected {
            border-color: #ef4444;
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.5);
        }
        
        /* Launch button styling */
        .launch-button {
            background-color: #374151; color: #e5e7eb; border: 3px solid #1f2937;
            box-shadow: 0 4px 0 0 #111827; transition: all 0.1s ease-in-out;
        }
        .launch-button:hover { background-color: #4b5563; }
        .launch-button:active, .launch-button.pressed {
            transform: translateY(4px);
            box-shadow: none;
        }

        /* Windows XP Pop-up Styling */
        .xp-popup-container {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 100;
            backdrop-filter: blur(2px);
            font-family: sans-serif;
            -webkit-font-smoothing: antialiased;
        }
        .xp-popup {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 350px;
            max-width: 90%;
            border-radius: 8px;
            border: 1px solid #4b4b4b;
            box-shadow: 8px 8px 15px rgba(0,0,0,0.25);
            background-color: #ece9d8;
            resize: both;
            overflow: hidden;
        }
        .xp-titlebar {
            padding: 3px 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: grab;
            height: 24px;
            color: white;
            font-size: 14px;
            font-weight: bold;
            text-shadow: 1px 1px #000;
            background: linear-gradient(to right, #0a246a, #a6caf0);
            border-bottom: 1px solid #000;
        }
        .xp-titlebar .close-btn {
            background-color: #ccc;
            width: 16px;
            height: 16px;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 1px solid #000;
            border-radius: 3px;
            color: #000;
            font-size: 16px;
            line-height: 1;
            cursor: pointer;
            text-shadow: none;
        }
        .xp-popup-content {
            padding: 1rem;
            color: #000;
            font-size: 14px;
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            body { align-items: flex-start; }
            .gba-container { flex-direction: column; border-radius: 1rem; }
            .gba-controls { flex-direction: column; gap: 2rem; margin-top: 1rem; }
        }
    </style>
</head>
<body>

    <div class="gba-container" tabindex="0"> <!-- Made container focusable -->
        <!-- Screen Area -->
        <div class="gba-screen">
            <header class="text-center mb-8">
                <h1 class="font-press-start text-2xl sm:text-3xl text-gray-800 tracking-tighter">KWERKY.IO</h1>
            </header>

            <main class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Project 1: Maze Runner -->
                <div class="project-card p-4 flex flex-col" data-index="0">
                    <div class="flex-grow">
                        <h2 class="font-press-start text-lg text-indigo-700 mb-2">Maze Runner</h2>
                        <p class="text-md mb-4">A digital labyrinth for humans, inspired by Micromouse. Can you find the exit faster than our AI?</p>
                    </div>
                    <a href="/maze-runner.html" class="launch-button mt-auto w-full text-center font-press-start text-sm py-3 rounded-md">SELECT</a>
                </div>

                <!-- Project 2: MemeForge -->
                <div class="project-card p-4 flex flex-col" data-index="1">
                    <div class="flex-grow">
                        <h2 class="font-press-start text-lg text-indigo-700 mb-2">MemeForge</h2>
                        <p class="text-md mb-4">Forge the dankest memes. A powerful tool for the modern digital blacksmith. Use responsibly.</p>
                    </div>
                    <a href="/meme-forge.html" class="launch-button mt-auto w-full text-center font-press-start text-sm py-3 rounded-md">SELECT</a>
                </div>

                <!-- Project 3: Plant Gen -->
                <div class="project-card p-4 flex flex-col" data-index="2">
                    <div class="flex-grow">
                        <h2 class="font-press-start text-lg text-indigo-700 mb-2">Plant Gen</h2>
                        <p class="text-md mb-4">Generate beautiful, complex plant-like structures using the power of L-System algorithms.</p>
                    </div>
                    <a href="/plant-gen.html" class="launch-button mt-auto w-full text-center font-press-start text-sm py-3 rounded-md">SELECT</a>
                </div>

                <!-- Project 4: AI Scientific Calculator -->
                <div class="project-card p-4 flex flex-col" data-index="3">
                    <div class="flex-grow">
                        <h2 class="font-press-start text-lg text-indigo-700 mb-2">AI Scientific Calculator</h2>
                        <p class="text-md mb-4">A powerful calculator that uses AI to perform complex scientific and astronomical calculations in seconds.</p>
                    </div>
                    <a href="/calculator.html" class="launch-button mt-auto w-full text-center font-press-start text-sm py-3 rounded-md">SELECT</a>
                </div>
                
                <!-- Future Project Slot -->
                <div class="project-card p-4 flex flex-col opacity-70" data-index="4">
                    <div class="flex-grow">
                        <h2 class="font-press-start text-lg text-gray-500 mb-2">???</h2>
                        <p class="text-md mb-4 text-gray-600">Another project is on the horizon. Stay tuned for the next level!</p>
                    </div>
                    <button disabled class="launch-button mt-auto w-full text-center font-press-start text-sm py-3 rounded-md opacity-50 cursor-not-allowed">LOCKED</button>
                </div>
            </main>
        </div>

        <!-- Controls Area -->
        <div class="gba-controls">
            <div class="d-pad">
                <div class="vertical"></div>
                <div class="horizontal"></div>
                <!-- Clickable overlays -->
                <div class="up" data-direction="up"></div>
                <div class="down" data-direction="down"></div>
                <div class="left" data-direction="left"></div>
                <div class="right" data-direction="right"></div>
            </div>
            
            <div class="flex items-center">
                <div class="text-center mr-8">
                    <h3 class="font-press-start text-lg text-gray-300">HACKATHON</h3>
                    <p class="font-silkscreen text-md text-gray-400">PROJECT SELECT</p>
                </div>
                <div class="ab-buttons">
                    <div id="b-button" class="button b-button">B</div>
                    <div id="a-button" class="button a-button">A</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Windows XP Pop-up -->
    <div id="xp-popup-container" class="xp-popup-container">
        <div id="xp-popup" class="xp-popup">
            <div id="xp-titlebar" class="xp-titlebar">
                <span>C:\WINDOWS\system32\kwerky.exe</span>
                <span id="close-btn" class="close-btn">&times;</span>
            </div>
            <div class="xp-popup-content">
                <p>Complete the following tasks to get an absolute creativity-pilled idea for your useless hackathon:</p>
                <ol class="list-decimal pl-4 mt-2">
                    <li>complete a run on maze runner on easy difficulty</li>
                    <li>create a meme</li>
                    <li>generate a plant animation</li>
                    <li>do the calculation $25 \times 4 \times \cos(30)$</li>
                </ol>
            </div>
        </div>
    </div>

    <!-- Audio element for the pop-up sound -->
    <!-- You would need to provide a valid URL for the audio file. -->
    <!-- For example, a .mp3 or .ogg file of a Windows error sound. -->
    <audio id="popup-sound" src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" preload="auto"></audio>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const cardsContainer = document.querySelector('main.grid');
            const cards = Array.from(document.querySelectorAll('.project-card'));
            const container = document.querySelector('.gba-container');
            const dPadVertical = document.querySelector('.d-pad .vertical');
            const dPadHorizontal = document.querySelector('.d-pad .horizontal');
            const dPadButtons = document.querySelectorAll('.d-pad [data-direction]');
            const cols = 3; // Hardcoded columns, could be dynamically calculated.
            let currentIndex = -1; // -1 means no card is selected initially

            // Pop-up elements
            const popupContainer = document.getElementById('xp-popup-container');
            const popupWindow = document.getElementById('xp-popup');
            const popupTitlebar = document.getElementById('xp-titlebar');
            const closeButton = document.getElementById('close-btn');
            const popupSound = document.getElementById('popup-sound');


            // --- POP-UP LOGIC ---
            /**
             * Shows the Windows XP pop-up.
             */
            function showPopup() {
                // Play the sound before showing the pop-up.
                if (popupSound) {
                    popupSound.play();
                }
                popupContainer.style.display = 'block';
            }

            /**
             * Hides the Windows XP pop-up.
             */
            function hidePopup() {
                popupContainer.style.display = 'none';
            }

            // Set a timer to show the pop-up after 2 seconds.
            setTimeout(showPopup, 2000);

            // Add an event listener to the close button.
            closeButton.addEventListener('click', hidePopup);

            // Make the pop-up draggable.
            let isDragging = false;
            let currentX;
            let currentY;
            let initialX;
            let initialY;
            let xOffset = 0;
            let yOffset = 0;

            popupTitlebar.addEventListener('mousedown', (e) => {
                initialX = e.clientX - xOffset;
                initialY = e.clientY - yOffset;
                isDragging = true;
                e.target.style.cursor = 'grabbing';
            });

            document.addEventListener('mouseup', () => {
                isDragging = false;
                popupTitlebar.style.cursor = 'grab';
            });

            document.addEventListener('mousemove', (e) => {
                if (isDragging) {
                    e.preventDefault();
                    currentX = e.clientX - initialX;
                    currentY = e.clientY - initialY;
                    xOffset = currentX;
                    yOffset = currentY;
                    setTranslate(currentX, currentY, popupWindow);
                }
            });

            function setTranslate(xPos, yPos, el) {
                el.style.transform = `translate(${xPos}px, ${yPos}px)`;
            }

            // --- SELECTION LOGIC ---
            /**
             * Selects a project card by its index, and handles visual changes.
             * @param {number} index The index of the card to select.
             */
            function selectCard(index) {
                // Remove 'selected' class from the previously selected card.
                const currentSelected = document.querySelector('.project-card.selected');
                if (currentSelected) {
                    currentSelected.classList.remove('selected');
                }
                
                // Add 'selected' class to the new card if the index is valid.
                if (index >= 0 && index < cards.length) {
                    const newCard = cards[index];
                    newCard.classList.add('selected');
                    currentIndex = index;
                } else {
                    currentIndex = -1;
                }
            }
            
            // --- ACTION LOGIC ---
            /**
             * Triggers the action (clicking the link) on the currently selected card.
             */
            function activateSelection() {
                if (currentIndex !== -1) {
                    const selectedCard = cards[currentIndex];
                    const actionButton = selectedCard.querySelector('a, button');
                    if (actionButton && !actionButton.disabled) {
                        // Add press animation to the SELECT button
                        actionButton.classList.add('pressed');
                        // Delay navigation slightly to allow animation to be visible
                        setTimeout(() => {
                            actionButton.click();
                        }, 150);
                    }
                }
            }

            /**
             * Deselects all cards.
             */
            function deselectAll() {
                selectCard(-1);
            }

            // --- A-BUTTON HANDLER ---
            /**
             * Handles the action for the A button.
             * If nothing is selected, select the first card.
             * If a card is selected, activate it.
             */
            function handleAButtonPress() {
                if (currentIndex === -1) {
                    selectCard(0);
                } else {
                    activateSelection();
                }
            }

            // --- EVENT LISTENERS ---

            // 1. Keyboard Navigation
            container.addEventListener('keydown', (e) => {
                // Prevent default browser behavior for arrow keys, enter, a, and b.
                if (['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'Enter', 'a', 'A', 'b', 'B'].includes(e.key)) {
                    e.preventDefault();
                }

                let newIndex = currentIndex;
                const totalCards = cards.length;

                // If nothing is selected, and we press a directional key, select the first card.
                if (currentIndex === -1 && ['ArrowLeft', 'ArrowRight', 'ArrowUp', 'ArrowDown'].includes(e.key)) {
                    newIndex = 0;
                } else {
                    switch (e.key) {
                        case 'ArrowRight':
                            newIndex = (currentIndex + 1) % totalCards;
                            break;
                        case 'ArrowLeft':
                            newIndex = (currentIndex - 1 + totalCards) % totalCards;
                            break;
                        case 'ArrowUp':
                            // Handle vertical navigation.
                            // If we're on the first row, wrap to the last.
                            if (currentIndex < cols) {
                                newIndex = totalCards - (cols - currentIndex);
                                if (newIndex < 0) newIndex = totalCards - 1; // Correct for last row being shorter
                            } else {
                                newIndex = currentIndex - cols;
                            }
                            break;
                        case 'ArrowDown':
                            // Handle vertical navigation.
                            // If we're on the last row, wrap to the first.
                            if (currentIndex >= totalCards - cols) {
                                newIndex = newIndex % cols;
                            } else {
                                newIndex = newIndex + cols;
                            }
                            break;
                    }
                }

                if (['ArrowLeft', 'ArrowRight', 'ArrowUp', 'ArrowDown'].includes(e.key)) {
                    selectCard(newIndex);
                }
                
                // Handle button press visuals and actions
                switch(e.key) {
                    case 'ArrowUp':
                    case 'ArrowDown':
                        dPadVertical.classList.add('pressed'); 
                        break;
                    case 'ArrowLeft':
                    case 'ArrowRight':
                        dPadHorizontal.classList.add('pressed'); 
                        break;
                    case 'Enter':
                    case 'a':
                    case 'A':
                        document.getElementById('a-button').classList.add('pressed');
                        handleAButtonPress();
                        break;
                    case 'Escape':
                    case 'b':
                    case 'B':
                        document.getElementById('b-button').classList.add('pressed');
                        deselectAll();
                        break;
                }
            });
            
            // Handle key up events to remove button press visuals.
            container.addEventListener('keyup', (e) => {
                switch(e.key) {
                    case 'ArrowUp':
                    case 'ArrowDown':
                        dPadVertical.classList.remove('pressed'); 
                        break;
                    case 'ArrowLeft':
                    case 'ArrowRight':
                        dPadHorizontal.classList.remove('pressed'); 
                        break;
                    case 'Enter':
                    case 'a':
                    case 'A': 
                        document.getElementById('a-button').classList.remove('pressed'); 
                        break;
                    case 'Escape':
                    case 'b':
                    case 'B': 
                        document.getElementById('b-button').classList.remove('pressed'); 
                        break;
                }
            });

            // 2. Mouse/Touch Click on Cards
            cards.forEach(card => {
                card.addEventListener('click', () => selectCard(parseInt(card.dataset.index, 10)));
            });

            // 3. D-Pad Clicks
            dPadButtons.forEach(button => {
                const direction = button.dataset.direction;
                const targetBar = ['up', 'down'].includes(direction) ? dPadVertical : dPadHorizontal;

                const press = (e) => { e.preventDefault(); targetBar.classList.add('pressed'); };
                const release = (e) => { e.preventDefault(); targetBar.classList.remove('pressed'); };

                button.addEventListener('mousedown', press);
                button.addEventListener('mouseup', release);
                button.addEventListener('mouseleave', release);
                button.addEventListener('touchstart', press, { passive: false });
                button.addEventListener('touchend', release, { passive: false });

                button.addEventListener('click', () => {
                    let newIndex = currentIndex === -1 ? 0 : currentIndex;
                    const totalCards = cards.length;
                    const cols = 3; // Same hardcoded value as above for consistency.

                    switch (direction) {
                        case 'right':
                            newIndex = (newIndex + 1) % totalCards;
                            break;
                        case 'left':
                            newIndex = (newIndex - 1 + totalCards) % totalCards;
                            break;
                        case 'up':
                             if (newIndex < cols) {
                                newIndex = totalCards - (cols - newIndex);
                                if (newIndex < 0) newIndex = totalCards - 1;
                            } else {
                                newIndex = newIndex - cols;
                            }
                            break;
                        case 'down':
                            if (newIndex >= totalCards - cols) {
                                newIndex = newIndex % cols;
                            } else {
                                newIndex = newIndex + cols;
                            }
                            break;
                    }
                    selectCard(newIndex);
                });
            });

            // 4. A/B Button Clicks
            document.getElementById('a-button').addEventListener('click', handleAButtonPress);
            document.getElementById('b-button').addEventListener('click', deselectAll);
            
            // Focus the container to enable keyboard events immediately
            container.focus();
        });
    </script>
</body>
</html>
